MODULE UTIL_TECLD_MOD

USE YOECLD, ONLY : TECLD

INTERFACE SAVE
MODULE PROCEDURE SAVE_TECLD
END INTERFACE

INTERFACE LOAD
MODULE PROCEDURE LOAD_TECLD
END INTERFACE

INTERFACE COPY
MODULE PROCEDURE COPY_TECLD
END INTERFACE

INTERFACE WIPE
MODULE PROCEDURE WIPE_TECLD
END INTERFACE



CONTAINS

SUBROUTINE SAVE_TECLD (KLUN, YD)

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TECLD), INTENT (IN), TARGET :: YD
LOGICAL :: LCETA
LCETA = ALLOCATED (YD%CETA)
WRITE (KLUN) LCETA
IF (LCETA) THEN
  WRITE (KLUN) LBOUND (YD%CETA)
  WRITE (KLUN) UBOUND (YD%CETA)
  WRITE (KLUN) YD%CETA
ENDIF
WRITE (KLUN) YD%RANVA
WRITE (KLUN) YD%RANVB
WRITE (KLUN) YD%RANVH
WRITE (KLUN) YD%RCCA
WRITE (KLUN) YD%RCCB
WRITE (KLUN) YD%RCCC
WRITE (KLUN) YD%RCFCT
WRITE (KLUN) YD%RCLWMR
WRITE (KLUN) YD%RCSCAL
WRITE (KLUN) YD%RDECORR_CF
WRITE (KLUN) YD%RDECORR_CW
WRITE (KLUN) YD%RETAHB
WRITE (KLUN) YD%RETAMB
WRITE (KLUN) YD%RLOIA
WRITE (KLUN) YD%RLOIB
WRITE (KLUN) YD%RLOIC
WRITE (KLUN) YD%RLOID
WRITE (KLUN) YD%RLONIA
WRITE (KLUN) YD%RLONIB
WRITE (KLUN) YD%RRHH
WRITE (KLUN) YD%RRHL
WRITE (KLUN) YD%RGAMMAS
WRITE (KLUN) YD%REPSCR
WRITE (KLUN) YD%REPSEC
WRITE (KLUN) YD%LOMEGA
END SUBROUTINE

SUBROUTINE LOAD_TECLD (KLUN, YD)
USE PARKIND1, ONLY : JPRD

IMPLICIT NONE
INTEGER, INTENT (IN) :: KLUN
TYPE (TECLD), INTENT (OUT), TARGET :: YD
INTEGER :: IL1(1), IU1(1)
LOGICAL :: LCETA
REAL(KIND=JPRD) :: ZTMP0
REAL(KIND=JPRD), ALLOCATABLE :: ZTMP1 (:)
READ (KLUN) LCETA
IF (LCETA) THEN
  READ (KLUN) IL1
  READ (KLUN) IU1
  ALLOCATE (YD%CETA (IL1(1):IU1(1)))
  ALLOCATE (ZTMP1(LBOUND(YD%CETA,1):UBOUND(YD%CETA,1)))
  READ (KLUN) ZTMP1
  YD%CETA = ZTMP1
  DEALLOCATE (ZTMP1)
ENDIF
READ (KLUN) ZTMP0
YD%RANVA = ZTMP0
READ (KLUN) ZTMP0
YD%RANVB = ZTMP0
READ (KLUN) ZTMP0
YD%RANVH = ZTMP0
READ (KLUN) ZTMP0
YD%RCCA = ZTMP0
READ (KLUN) ZTMP0
YD%RCCB = ZTMP0
READ (KLUN) ZTMP0
YD%RCCC = ZTMP0
READ (KLUN) ZTMP0
YD%RCFCT = ZTMP0
READ (KLUN) ZTMP0
YD%RCLWMR = ZTMP0
READ (KLUN) ZTMP0
YD%RCSCAL = ZTMP0
READ (KLUN) ZTMP0
YD%RDECORR_CF = ZTMP0
READ (KLUN) ZTMP0
YD%RDECORR_CW = ZTMP0
READ (KLUN) ZTMP0
YD%RETAHB = ZTMP0
READ (KLUN) ZTMP0
YD%RETAMB = ZTMP0
READ (KLUN) ZTMP0
YD%RLOIA = ZTMP0
READ (KLUN) ZTMP0
YD%RLOIB = ZTMP0
READ (KLUN) ZTMP0
YD%RLOIC = ZTMP0
READ (KLUN) ZTMP0
YD%RLOID = ZTMP0
READ (KLUN) ZTMP0
YD%RLONIA = ZTMP0
READ (KLUN) ZTMP0
YD%RLONIB = ZTMP0
READ (KLUN) ZTMP0
YD%RRHH = ZTMP0
READ (KLUN) ZTMP0
YD%RRHL = ZTMP0
READ (KLUN) ZTMP0
YD%RGAMMAS = ZTMP0
READ (KLUN) ZTMP0
YD%REPSCR = ZTMP0
READ (KLUN) ZTMP0
YD%REPSEC = ZTMP0
READ (KLUN) YD%LOMEGA
END SUBROUTINE


SUBROUTINE COPY_TECLD (YD, LDCREATED)

IMPLICIT NONE
TYPE (TECLD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDCREATED
LOGICAL :: LLCREATED
LOGICAL :: LCETA

LLCREATED = .FALSE.
IF (PRESENT (LDCREATED)) THEN
  LLCREATED = LDCREATED
ENDIF
IF (.NOT. LLCREATED) THEN
  !$acc enter data create (YD)
  !$acc update device (YD)
ENDIF
LCETA = ALLOCATED (YD%CETA)
IF (LCETA) THEN
  !$acc enter data create (YD%CETA)
  !$acc update device (YD%CETA)
  !$acc enter data attach (YD%CETA)
ENDIF


























END SUBROUTINE

SUBROUTINE WIPE_TECLD (YD, LDDELETED)

IMPLICIT NONE
TYPE (TECLD), INTENT (IN), TARGET :: YD
LOGICAL, OPTIONAL, INTENT (IN) :: LDDELETED
LOGICAL :: LLDELETED
LOGICAL :: LCETA

LCETA = ALLOCATED (YD%CETA)
IF (LCETA) THEN
  !$acc exit data detach (YD%CETA)
  !$acc exit data delete (YD%CETA)
ENDIF


























LLDELETED = .FALSE.
IF (PRESENT (LDDELETED)) THEN
  LLDELETED = LDDELETED
ENDIF
IF (.NOT. LLDELETED) THEN
  !$acc exit data delete (YD)
ENDIF
END SUBROUTINE



END MODULE
